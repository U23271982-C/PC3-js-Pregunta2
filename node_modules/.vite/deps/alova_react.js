import {
  require_react
} from "./chunk-YX2XZWS3.js";
import {
  falseValue,
  isNumber,
  noop,
  undefinedValue
} from "./chunk-PH77QZA5.js";
import {
  __toESM
} from "./chunk-G3PMV62Z.js";

// node_modules/alova/dist/stateshook/react.esm.js
var import_react = __toESM(require_react());
var stateToData = (reactState) => 2 in reactState ? reactState[2] : reactState[0];
var refCurrent = (ref) => ref.current;
var setRef = (ref, newVal) => {
  ref.current = newVal;
};
var react = {
  name: "React",
  create: (initialValue) => (0, import_react.useState)(initialValue),
  export: stateToData,
  dehydrate: stateToData,
  update: (newVal, state) => {
    state[2] = newVal;
    state[1](newVal);
  },
  memorize: (fn) => {
    const fnRef = (0, import_react.useRef)(noop);
    setRef(fnRef, fn);
    return (0, import_react.useCallback)((...args) => refCurrent(fnRef)(...args), []);
  },
  ref: (initialValue) => {
    const refObj = (0, import_react.useRef)(initialValue);
    refCurrent(refObj) === undefinedValue && setRef(refObj, initialValue);
    return refObj;
  },
  effectRequest({ handler, removeStates, immediate, watchingStates = [] }) {
    const oldStates = (0, import_react.useRef)(watchingStates);
    (0, import_react.useEffect)(() => {
      const oldStatesValue = refCurrent(oldStates);
      let changedIndex = undefinedValue;
      for (const index in watchingStates) {
        if (!Object.is(oldStatesValue[index], watchingStates[index])) {
          changedIndex = Number(index);
          break;
        }
      }
      setRef(oldStates, watchingStates);
      if (immediate || isNumber(changedIndex)) {
        handler(changedIndex);
      }
    }, watchingStates);
    (0, import_react.useEffect)(() => removeStates, []);
  },
  computed: (getter, depList) => {
    const memo = (0, import_react.useMemo)(getter, depList);
    return [memo, noop];
  },
  watch: (states, callback) => {
    const needEmit = (0, import_react.useRef)(falseValue);
    (0, import_react.useEffect)(() => {
      needEmit.current ? callback() : needEmit.current = true;
    }, states);
  },
  onMounted: (callback) => {
    (0, import_react.useEffect)(callback, []);
  },
  onUnmounted: (callback) => {
    (0, import_react.useEffect)(() => callback, []);
  }
};
export {
  react as default
};
//# sourceMappingURL=alova_react.js.map
